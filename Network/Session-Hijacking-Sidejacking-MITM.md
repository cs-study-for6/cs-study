# 세션 하이재킹

## 세션 하이재킹 (Session Hijacking) 정의

세션 하이재킹은 인터넷에서의 보안 위협 중 하나로, 해커가 사용자의 인터넷 세션을 빼앗아 무단으로 접근하는 것을 말한다.

사용자가 로그인 한 후에도, 해당 세션을 가져가면서 사용자처럼 행동할 수 있게 된다. 주로 쿠키나 세션 ID를 훔쳐서 이를 이용하게 되며, 이로써 사용자의 계정에 무단으로 접근하여 중요한 정보를 탈취하거나 조작할 수 있다.

이러한 공격은 사용자의 개인 정보와 온라인 안전에 심각한 위협을 가하므로, 보안 조치가 필요하다.

<br>

## 세션 하이재킹 원리

사용자는 로그인 하면서 자격 증명을 웹 서버로 전송한다. 웹 서버는 사용자가 누구인지 파악하고 세션 내내 쿠키를 이용해 해당 사용자에게 세션 ID를 부여한다. 이로 인해 페이지를 새로고침 하여도 장바구니에 넣은 물건들을 웹사이트가 기억하는 것이다.

그런데 이 세션을 가로채면 범죄자는 웹 서버를 속여 권한이 있는 사용자로부터 요청이 들어온 것으로 착각하게 만들 수 있다. 이것이 세션 하이재킹(가로채기)이다. 이 수법을 통해 범죄자는 아이디, 비밀번호를 알지 않더라도 사용자들 대신해 은행 송금이나 온라인 구매와 같은 작업을 수행할 수 있는 것이다.

<br>

## 세션 하이재킹 유형

세션 하이재킹은 크게 두 가지 유형이 있다.

1. <b>능동형</b>

능동형 공격에서는 해커가 사용자의 세션을 장악하고 디바이스가 웹 서버와 통신하지 못하도록 사용자를 차단한다. 해커는 사용자처럼 온라인 구매를 하거나 비밀번호를 변경하는 등의 작업을 할 수 있다.

2. <b>수동형</b>

수동형 공격에서는 사용자가 세션에서 쫓겨나지 않는다. 해커는 사용자의 기기와 서버 간의 데이터 트래픽을 관찰하며 중요한 정보를 수집한다. 이렇게 하여 의심을 사지 않고 중요 정보를 탈취할 수 있는 것이다.

<br>

## 세션 하이재킹 발생 경로

세션 하이재킹 공격이 수행되는 방법에는 여러 가지가 있다. 웹 서버의 취약점을 이용하거나, 사용자 측의 허술한 보안을 이용하기도 한다. 대부분의 경우 세션 하이재킹 공격은 유효한 세션 토큰을 훔치거나 예측하여 세션 토큰을 손상시켜 웹 서버에 대한 무단 액세스를 얻는다.

세션 하이재킹이 발생하는 방식으로는 다음과 같은 것들이 있다.

* <b>세션 사이드재킹</b> - 공격자는 스니핑 소프트웨어를 사용하며 공공 와이파이 또는 SSL 인증서가 없는 웹사이트를 표적으로 삼는다.
* <b>세션 고정</b> - 공격자는 자신이 만든 세션 ID를 사용하도록 유도한다. 피싱 수법을 사용해 세션ID를 특정 웹사이트로 '고정'하는 악성 링크를 클릭하도록 유도하고, 세션을 탈취한다.
* <b>무차별 암호 대입</b> - 해커는 가능한 모든 조합을 시도하여 세션ID를 추측하고 세션을 탈취한다. 쿠키를 훔치는 것이 아닌, 브루트 포스로 세션ID를 무차별 대입하는 것이다. (가장 비효율적)
* <b>크로스 사이트 스크립팅</b> - 해커는 웹사이트나 어플리케이션의 취약점을 활용해 악성 코드를 삽입하고, 사용자가 해당 사이트를 방문했을 때 악성 코드가 활성화되어 사용자의 쿠키를 훔친다.
* <b>IP 스푸핑</b> - 해커는 패킷의 원래 IP를 변경하여 사용자가 보낸 것처럼 보이게 한다. 웹사이트에 연결할 때 3-Way-Hanshake를 해야 하고, 해커가 스푸핑된 IP로 끼어들면 웹 서버는 처음부터 사용자로 착각한다.

위 방식들 중 특히 세션 사이드재킹에 대해 구체적으로 알아보겠다.

<br>

## 세션 사이드재킹 (Session Sidejacking)

세션 사이드재킹은 주로 공공 와이파이나 불안전한 네트워크에서 발생한다. 해커가 해당 네트워크를 통해 피해자의 트래픽을 감시하고, 트래픽에서 세션 쿠키나 인증 정보를 훔쳐오는 것이다. 해커는 이를 사용하여 해당 사용자의 세션을 적절하게 재현하여 악용할 수 있다.

세션 사이드재킹은 주로 네트워크 패킷 스니핑과 같은 기술을 사용하여 수행된다. 공격자는 피해자와 웹 서버 간의 통신을 감시하여 세션 쿠키나 기타 인증 정보를 훔치는데, 이를 위해 네트워크 상에서 패킷을 캡처하고 분석하여 쿠키를 탈취한다. 이러한 공격은 피해자가 공공 와이파이나 공용 네트워크를 사용할 때 특히 취약하다.

<br>

## 세션 사이드재킹 방지하는 법

세션 사이드재킹을 방지하기 위해서는 안전한 HTTPS 연결을 사용하고, 공공 와이파이나 불안전한 네트워크를 사용할 때에는 VPN(Virtual Private Network)을 통해 통신을 암호화하는 것이 중요하다. 또한 사용자 인증 시에는 다단계 인증(Multi-factor authentication)과 같은 추가적인 보안 기능을 사용하여 보안을 강화할 수 있다.

<br>

## 세션 하이재킹을 방지하는 법

* 공용 와이파이를 사용하지 않는다. 데이터 트래픽이 노출될 수 있기 때문이다.
* URL 옆에 작은 자물쇠가 있는 사이트만 이용한다. SSL 인증서를 사용하지 않는 웹사이트는 사용자와 웹사이트 간의 트래픽을 암호화하지 못해 보안에 취약하다.
* 멀웨어 방지 앱을 다운로드 한다. 멀웨어가 포함된 파일을 식별하고, 악성 웹사이트 방문을 차단한다.
* 공식 스토어에서만 앱을 구매하고 다운로드 받는다.
* 알 수 없는 링크를 열지 않는다. 감염된 웹사이트를 방문하도록 유도하는 수법일 수 있다.
* VPN을 사용한다. VPN은 원래 IP 주소를 마스킹하고 사용자와 웹사이트 간에 암호화된 터널을 생성하여 보안을 유지한다. 이렇게 하면 공격자가 네트워크에 침입할 수 없다.

<br><br><br>

# 중간자 공격

## 중간자 공격 (MTIM) 정의

중간자 공격(MITM: Man In The Middle)은 공격자가 사용자의 인터넷 서버와 해당 인터넷 트래픽의 목적지 사이에 끼어들어 데이터를 가로채는 공격이다. 2명의 사용자 사이에 끼어들기도 한다.

어떤 사용자가 웹사이트나 어플리케이션을 사용하며 다른 사용자에게 중요 데이터를 전송하면, 중간자가 데이터의 흐름을 조작하고 데이터를 탈취하는 것이다.

<br>

## 중간자 공격 원리

MITM 공격은 일반적으로 공격자가 피해자와 목표 서버 간의 통신을 중간에서 가로채고, 그들에게 자신이 두 당사자 중 하나인 것처럼 속임수를 쓰는 것으로 이루어진다. 이를 통해 공격자는 피해자와 서버 간의 모든 통신을 엿들을 수 있으며, 필요한 경우 통신 내용을 조작하여 비밀 정보를 탈취하거나 사용자의 동의 없이 중요한 작업을 수행할 수 있다.

MITM 공격은 공공 와이파이나 불안전한 네트워크에서 특히 취약하며, 주로 패킷 스니핑(Packet Sniffing)이나 ARP Spoofing과 같은 기술을 사용하여 수행된다. 

중간자 공격은 다음과 같은 순서로 작동한다.

1. <b>중간에 들어가기</b> - 공격자는 피해자와 목표 서버 간의 통신 경로 중간에 들어간다. ARP Spoofing과 같은 기술을 이용하여 공격자는 네트워크 내에서 다른 컴퓨터로부터 피해자의 트래픽을 가로챈다.
2. <b>통신 중간에서 감시하기</b> - 공격자가 통신 경로에 들어간 후, 피해자와 목표 서버 간의 모든 통신을 감시한다.
3. <b>통신 조작</b> - 통신을 감시하는 중간에 필요하다면 데이터를 조작할 수 있다. 중요 정보를 탈취하거나, 피해자의 동의 없이 중요한 작업을 수행할 수 있다.
4. <b>피해자 속임수</b> - 공격자가 통신을 가로채고 조작한 후, 피해자와 목표 서버 간의 통신이 원래의 것과 동일하다고 속임수를 쓴다. 이를 통해 피해자는 공격을 감지하지 못하고 계속해서 공격자와 통신을 이어나갈 수 있다.

<br>

## 중간자 공격 유형

* IP 스푸핑 - 해커는 탈취한 IP를 통해 인증 과정을 우회하고 장치 또는 어플리케이션에 접근한다.
* 이메일 하이재킹 - 하이재킹의 여러 수법 중에서 이메일에 포함된 중요 데이터를 탈취하는 공격 방식. 공격자는 사용자의 활동을 모니터링하고, 이메일에 개인 정보와 금융 정보 등 중요 데이터가 포착되면 공격을 수행한다.
* 맨 인 더 브라우저 공격 - 트로이 목마로 해킹 수행하는 방법. 트래픽을 리다이렉션 해 사용자에게 가짜 웹사이트를 표시하고 사용자가 가짜 웹사이트에 정보를 입력하도록 유도한다.
* 와이파이 도청 - 기존 와이파이를 해킹하거나 직접 핫스팟을 설치함으로써 와이파이에 연결한 사람의 활동을 도청하는 방식. SSL 스트리핑이라는 기법을 이용해 암호화되지 않은 연결을 통해 전송되는 모든 데이터를 확인할 수 있다.
* 브라우저 쿠키 탈취 - 브라우저 쿠키에는 웹사이트가 사용자 장치에 저장하는 정보가 포함되어 있으며, 쿠키에 포함된 로그인 정보는 해킹의 표적이 되기 쉽다.

<br>

## 중간자 공격을 방지하는 법

* 보안 소프트웨어 설치 - 보안 소프트웨어를 설치하면, 첨부파일과 링크를 열지 않고도 멀웨어 감염 여부를 화긴할 수 있고, 실수로 링크를 열어 감염되더라도 안전한 장소에 격리하고 제거할 수 있다.
* 보안성 높은 비밀번호 사용 및 사이트마다 비밀번호 다르게 설정 - 모든 웹사이트에 동일한 비밀번호를 사용했다가는, 중간자 공격으로 비밀번호가 유출되면 모든 계정이 해킹당할 수 있다.
* 공유기 보안 확보 - 중간자 공격은 주로 보호되지 않는 공용 와이파이를 통해 이뤄진다. 
* 이메일 사용 시 주의 - 이메일로 로그인 정보 등 중요 데이터를 공유해서는 안 되고, 알 수 없는 링크와 첨부파일은 피싱 사기로 이어질 수 있으므로 주의해야 한다.
* 엔드포인트 보안 시스템 구축 - 기업의 경우 직원이 해커에게 실수로 네트워크 액세스 권한을 넘겨줄 수 있으므로, 엔드포인트 보안 시스템을 구축한다.

<br><br>

## 정리

세션 하이재킹, 세션 사이드재킹 그리고 중간자 공격을 정리하면 다음과 같다.

### 세션 하이재킹

세션 하이재킹에는 공격자가 사용자의 세션 정보나 세션 식별자를 훔치는 것이 포함된다. 이는 일반적으로 사용자가 보안 시스템이나 웹사이트에 이미 로그인한 후에 발생한다. 그런 다음 공격자는 훔친 세션 정보를 사용하여 사용자를 가장하고 사용자 계정이나 민감한 정보에 대한 무단 액세스 권한을 얻는다.

<br>

### 세션 사이드재킹

세션 사이드재킹은 특히 공용 Wi-Fi 네트워크와 같이 안전하지 않은 네트워크 환경에서 발생하는 세션 하이재킹의 한 유형이다. 세션 사이드재킹에서 공격자는 세션 쿠키나 인증 토큰을 훔치기 위해 사용자와 서버 간의 통신을 가로챈다. 공격자는 도난당한 자격 증명을 사용하여 사용자를 가장하고 세션을 하이재킹 한다.

<br>

### 중간자 공격

중간자 공격에는 공격자가 자신도 모르게 두 당사자 간의 통신을 가로채서 변경하는 것이 포함된다. 세션 하이재킹 또는 사이드재킹의 맥락에서 MITM 공격은 사용자와 서버 사이에 공격자를 배치하여 이러한 공격을 용이하게 하는 데 사용될 수 있다. 공격자는 통신을 가로채고, 세션 정보를 훔치며, 사용자와 서버 간에 교환되는 데이터를 수정할 수 있다.

<br>

요약하면, 세션 하이재킹과 세션 사이드재킹은 세션 정보를 훔치는 것을 목표로 하는 특정 유형의 공격이다. 그리고 세션 사이드재킹은 안전하지 않는 네트워크 환경에 중점을 둔다.

반면 MITM 공격은 공격자가 두 당사자 간의 통신을 가로채서 변경하여 세션 하이재킹이나 사이드재킹을 용이하게 하는 광범위한 공격을 포괄한다.


<br><br><br><br>

[참고자료]

<a href="https://nordvpn.com/ko/blog/session-hijacking-explained/">세션 하이재킹이란? 어떻게 피할 수 있을까요?</a>

<a href="https://nordvpn.com/ko/blog/mitm/">중간자 공격의 의미와 예방 방법</a>